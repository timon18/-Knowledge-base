---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠==


# Text Elements
FrontEnd ^3S00jMTJ

BackEnd ^pclDWn17

Пользователь поставил 
галочку запомнить меня
Или не поставил ^nZ1keZoA

{
    "email"
    "password"
    "rememberMe"
} ^xJ57sM3a

Записываем в Cookie token1:token2 ^tTCRs8QR

Создаём два идентификатора
 и записываем их в базу данных. 
id | token1 | token2 | user_id | updateTime | LifeTime ^PbRth3ub

Любой запрос ^aJNcan9o

Проверяем есть ли токен1. 
Проверяем равен ли токен 2.
Проверяем не устарел ли токен.
Если что то не равно - то удаляем 
и из базы и из cookie и отправляем ошибку.
 ^9MxJA6lE

cookie = token1:token2 ^9FBoOYDg

Все эти проверки делаем до
проверки аксесс токена ^QNjkM0Xr

%%
# Drawing
```json
{
	"type": "excalidraw",
	"version": 2,
	"source": "https://excalidraw.com",
	"elements": [
		{
			"type": "rectangle",
			"version": 175,
			"versionNonce": 2096073202,
			"isDeleted": false,
			"id": "UrW-d-GuTPzjbeATaR785",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -587.1322021484375,
			"y": -283.273193359375,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 285.2757568359375,
			"height": 347.7761535644531,
			"seed": 934364910,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [
				{
					"id": "Lxazl8p45mvnhQc0DvqZ7",
					"type": "arrow"
				},
				{
					"id": "1cPMmpYqGdZOTSQx_qdhe",
					"type": "arrow"
				}
			],
			"updated": 1651071304955,
			"link": null
		},
		{
			"type": "rectangle",
			"version": 151,
			"versionNonce": 932286386,
			"isDeleted": false,
			"id": "eZ8nKASsV9Mh78S3rHvxP",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 190.8262939453125,
			"y": -281.6541748046875,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 404.1031494140625,
			"height": 355.1340789794922,
			"seed": 688250414,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [
				{
					"id": "Lxazl8p45mvnhQc0DvqZ7",
					"type": "arrow"
				}
			],
			"updated": 1651071308694,
			"link": null
		},
		{
			"type": "text",
			"version": 81,
			"versionNonce": 1913486258,
			"isDeleted": false,
			"id": "3S00jMTJ",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -491.7291259765625,
			"y": -316.8569793701172,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 83,
			"height": 23,
			"seed": 854123118,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 20,
			"fontFamily": 2,
			"text": "FrontEnd",
			"rawText": "FrontEnd",
			"baseline": 18,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "FrontEnd"
		},
		{
			"type": "text",
			"version": 60,
			"versionNonce": 475975790,
			"isDeleted": false,
			"id": "pclDWn17",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": 327.1348876953125,
			"y": -310.8975830078125,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 81,
			"height": 23,
			"seed": 1037333806,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 20,
			"fontFamily": 2,
			"text": "BackEnd",
			"rawText": "BackEnd",
			"baseline": 18,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "BackEnd"
		},
		{
			"type": "text",
			"version": 148,
			"versionNonce": 2047292786,
			"isDeleted": false,
			"id": "nZ1keZoA",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 1,
			"opacity": 100,
			"angle": 0,
			"x": -563.3533935546875,
			"y": -262.29180908203125,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 185,
			"height": 54,
			"seed": 1303387822,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 16,
			"fontFamily": 2,
			"text": "Пользователь поставил \nгалочку запомнить меня\nИли не поставил",
			"rawText": "Пользователь поставил \nгалочку запомнить меня\nИли не поставил",
			"baseline": 50,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Пользователь поставил \nгалочку запомнить меня\nИли не поставил"
		},
		{
			"type": "arrow",
			"version": 485,
			"versionNonce": 281133759,
			"isDeleted": false,
			"id": "Lxazl8p45mvnhQc0DvqZ7",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -279.66994288262737,
			"y": -250.75144342094984,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 449.55569734448943,
			"height": 1.3237207261612411,
			"seed": 1225952754,
			"groupIds": [],
			"strokeSharpness": "round",
			"boundElements": [],
			"updated": 1651125925548,
			"link": null,
			"startBinding": {
				"elementId": "UrW-d-GuTPzjbeATaR785",
				"focus": -0.8137985200379481,
				"gap": 22.186502429872633
			},
			"endBinding": {
				"elementId": "eZ8nKASsV9Mh78S3rHvxP",
				"focus": 0.8120923633164923,
				"gap": 20.940539483450436
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					449.55569734448943,
					1.3237207261612411
				]
			]
		},
		{
			"type": "text",
			"version": 238,
			"versionNonce": 1445181234,
			"isDeleted": false,
			"id": "xJ57sM3a",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -157.40789794921875,
			"y": -337.1055450439453,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 118,
			"height": 85,
			"seed": 1291400498,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 15.130853949652774,
			"fontFamily": 2,
			"text": "{\n    \"email\"\n    \"password\"\n    \"rememberMe\"\n}",
			"rawText": "{\n    \"email\"\n    \"password\"\n    \"rememberMe\"\n}",
			"baseline": 82,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "{\n    \"email\"\n    \"password\"\n    \"rememberMe\"\n}"
		},
		{
			"type": "arrow",
			"version": 220,
			"versionNonce": 239439807,
			"isDeleted": false,
			"id": "1cPMmpYqGdZOTSQx_qdhe",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 158.8262939453125,
			"y": -153.5268399369664,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 447.4029548059527,
			"height": 4.499032645752209,
			"seed": 86615278,
			"groupIds": [],
			"strokeSharpness": "round",
			"boundElements": [],
			"updated": 1651125922683,
			"link": null,
			"startBinding": null,
			"endBinding": {
				"elementId": "UrW-d-GuTPzjbeATaR785",
				"focus": -0.286378913302297,
				"gap": 13.279784451859825
			},
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					-447.4029548059527,
					-4.499032645752209
				]
			]
		},
		{
			"type": "text",
			"version": 76,
			"versionNonce": 113901810,
			"isDeleted": false,
			"id": "tTCRs8QR",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -181.839111328125,
			"y": -183.30084228515625,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 268,
			"height": 18,
			"seed": 274161842,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 16,
			"fontFamily": 2,
			"text": "Записываем в Cookie token1:token2",
			"rawText": "Записываем в Cookie token1:token2",
			"baseline": 14,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Записываем в Cookie token1:token2"
		},
		{
			"type": "text",
			"version": 146,
			"versionNonce": 596131630,
			"isDeleted": false,
			"id": "PbRth3ub",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 207.34130859375,
			"y": -263.3250427246094,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 372,
			"height": 54,
			"seed": 1437420142,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 16,
			"fontFamily": 2,
			"text": "Создаём два идентификатора\n и записываем их в базу данных. \nid | token1 | token2 | user_id | updateTime | LifeTime",
			"rawText": "Создаём два идентификатора\n и записываем их в базу данных. \nid | token1 | token2 | user_id | updateTime | LifeTime",
			"baseline": 50,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Создаём два идентификатора\n и записываем их в базу данных. \nid | token1 | token2 | user_id | updateTime | LifeTime"
		},
		{
			"type": "rectangle",
			"version": 41,
			"versionNonce": 1736512178,
			"isDeleted": false,
			"id": "9Qwhyr3g68Y_H_tlIxQvw",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -566.2308349609375,
			"y": -80.31002807617188,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 249.16162109375,
			"height": 42.490142822265625,
			"seed": 1675796466,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [
				{
					"type": "text",
					"id": "aJNcan9o"
				},
				{
					"id": "7yxx96lOyHZK8yaz-LyV2",
					"type": "arrow"
				}
			],
			"updated": 1651071304955,
			"link": null
		},
		{
			"type": "text",
			"version": 37,
			"versionNonce": 450111854,
			"isDeleted": false,
			"id": "aJNcan9o",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -561.2308349609375,
			"y": -68.06495666503906,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 239.16162109375,
			"height": 18,
			"seed": 1773497646,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 16.010819822175733,
			"fontFamily": 2,
			"text": "Любой запрос",
			"rawText": "Любой запрос",
			"baseline": 14,
			"textAlign": "center",
			"verticalAlign": "middle",
			"containerId": "9Qwhyr3g68Y_H_tlIxQvw",
			"originalText": "Любой запрос"
		},
		{
			"type": "arrow",
			"version": 104,
			"versionNonce": 2086226431,
			"isDeleted": false,
			"id": "7yxx96lOyHZK8yaz-LyV2",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -311.5247802734375,
			"y": -59.62518310546875,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 536.851806640625,
			"height": 4.17657470703125,
			"seed": 845576174,
			"groupIds": [],
			"strokeSharpness": "round",
			"boundElements": [],
			"updated": 1651125664184,
			"link": null,
			"startBinding": {
				"elementId": "9Qwhyr3g68Y_H_tlIxQvw",
				"gap": 5.54443359375,
				"focus": -0.0707908967819313
			},
			"endBinding": null,
			"lastCommittedPoint": null,
			"startArrowhead": null,
			"endArrowhead": "arrow",
			"points": [
				[
					0,
					0
				],
				[
					536.851806640625,
					4.17657470703125
				]
			]
		},
		{
			"type": "text",
			"version": 259,
			"versionNonce": 229165998,
			"isDeleted": false,
			"id": "9MxJA6lE",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 251.567626953125,
			"y": -72.6951904296875,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 333,
			"height": 108,
			"seed": 2107294638,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 16,
			"fontFamily": 2,
			"text": "Проверяем есть ли токен1. \nПроверяем равен ли токен 2.\nПроверяем не устарел ли токен.\nЕсли что то не равно - то удаляем \nи из базы и из cookie и отправляем ошибку.\n",
			"rawText": "Проверяем есть ли токен1. \nПроверяем равен ли токен 2.\nПроверяем не устарел ли токен.\nЕсли что то не равно - то удаляем \nи из базы и из cookie и отправляем ошибку.\n",
			"baseline": 104,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Проверяем есть ли токен1. \nПроверяем равен ли токен 2.\nПроверяем не устарел ли токен.\nЕсли что то не равно - то удаляем \nи из базы и из cookie и отправляем ошибку.\n"
		},
		{
			"type": "text",
			"version": 17,
			"versionNonce": 383618610,
			"isDeleted": false,
			"id": "9FBoOYDg",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": -150.494384765625,
			"y": -48.5682373046875,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 166,
			"height": 18,
			"seed": 1941516402,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 16,
			"fontFamily": 2,
			"text": "cookie = token1:token2",
			"rawText": "cookie = token1:token2",
			"baseline": 14,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "cookie = token1:token2"
		},
		{
			"type": "text",
			"version": 136,
			"versionNonce": 2049910254,
			"isDeleted": false,
			"id": "QNjkM0Xr",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 326.017578125,
			"y": -156.6400146484375,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 217,
			"height": 36,
			"seed": 535095986,
			"groupIds": [],
			"strokeSharpness": "sharp",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"fontSize": 16,
			"fontFamily": 2,
			"text": "Все эти проверки делаем до\nпроверки аксесс токена",
			"rawText": "Все эти проверки делаем до\nпроверки аксесс токена",
			"baseline": 32,
			"textAlign": "left",
			"verticalAlign": "top",
			"containerId": null,
			"originalText": "Все эти проверки делаем до\nпроверки аксесс токена"
		},
		{
			"type": "freedraw",
			"version": 22,
			"versionNonce": 1613821938,
			"isDeleted": false,
			"id": "ejSDB3lxjpNppNFOdhqNI",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 323.7088623046875,
			"y": -142.52996826171875,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 36.8201904296875,
			"height": 45.74676513671875,
			"seed": 158952306,
			"groupIds": [],
			"strokeSharpness": "round",
			"boundElements": [],
			"updated": 1651071304955,
			"link": null,
			"points": [
				[
					0,
					0
				],
				[
					-0.228515625,
					0
				],
				[
					-1.5596923828125,
					0
				],
				[
					-4.517333984375,
					0
				],
				[
					-9.2755126953125,
					0.9285888671875
				],
				[
					-13.28094482421875,
					2.693359375
				],
				[
					-21.8343505859375,
					6.06646728515625
				],
				[
					-26.34722900390625,
					9.58160400390625
				],
				[
					-31.91156005859375,
					15.702392578125
				],
				[
					-34.03802490234375,
					20.054595947265625
				],
				[
					-36.2637939453125,
					27.84466552734375
				],
				[
					-36.8201904296875,
					36.49755859375
				],
				[
					-36.8201904296875,
					41.255767822265625
				],
				[
					-36.52886962890625,
					43.0037841796875
				],
				[
					-36.30029296875,
					43.918121337890625
				],
				[
					-36.07171630859375,
					44.375274658203125
				],
				[
					-35.8431396484375,
					45.06103515625
				],
				[
					-35.61456298828125,
					45.5181884765625
				],
				[
					-35.385986328125,
					45.74676513671875
				],
				[
					-35.385986328125,
					45.74676513671875
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		},
		{
			"type": "freedraw",
			"version": 21,
			"versionNonce": 829437998,
			"isDeleted": false,
			"id": "Jyyu7RUQPJIBWXaAf3NZs",
			"fillStyle": "hachure",
			"strokeWidth": 1,
			"strokeStyle": "solid",
			"roughness": 0,
			"opacity": 100,
			"angle": 0,
			"x": 280.92474365234375,
			"y": -109.41058349609375,
			"strokeColor": "#000000",
			"backgroundColor": "transparent",
			"width": 29.45367431640625,
			"height": 36.6236572265625,
			"seed": 876305198,
			"groupIds": [],
			"strokeSharpness": "round",
			"boundElements": [],
			"updated": 1651071304956,
			"link": null,
			"points": [
				[
					0,
					0
				],
				[
					0,
					0.4571533203125
				],
				[
					0,
					0.914306640625
				],
				[
					0.6024169921875,
					7.96246337890625
				],
				[
					1.204833984375,
					15.763092041015625
				],
				[
					2.26287841796875,
					22.800384521484375
				],
				[
					3.9896240234375,
					31.353759765625
				],
				[
					5.20947265625,
					34.60675048828125
				],
				[
					6.24932861328125,
					36.39508056640625
				],
				[
					6.24932861328125,
					36.6236572265625
				],
				[
					6.4779052734375,
					36.6236572265625
				],
				[
					8.80035400390625,
					34.821136474609375
				],
				[
					14.44451904296875,
					28.701141357421875
				],
				[
					20.026123046875,
					22.597625732421875
				],
				[
					25.824951171875,
					15.03985595703125
				],
				[
					28.18524169921875,
					12.6795654296875
				],
				[
					29.45367431640625,
					11.11981201171875
				],
				[
					29.45367431640625,
					10.8912353515625
				],
				[
					29.45367431640625,
					10.8912353515625
				]
			],
			"lastCommittedPoint": null,
			"simulatePressure": true,
			"pressures": []
		}
	],
	"appState": {
		"theme": "light",
		"viewBackgroundColor": "#ffffff",
		"currentItemStrokeColor": "#000000",
		"currentItemBackgroundColor": "transparent",
		"currentItemFillStyle": "hachure",
		"currentItemStrokeWidth": 1,
		"currentItemStrokeStyle": "solid",
		"currentItemRoughness": 0,
		"currentItemOpacity": 100,
		"currentItemFontFamily": 2,
		"currentItemFontSize": 16,
		"currentItemTextAlign": "left",
		"currentItemStrokeSharpness": "sharp",
		"currentItemStartArrowhead": null,
		"currentItemEndArrowhead": "arrow",
		"currentItemLinearStrokeSharpness": "round",
		"gridSize": null,
		"colorPalette": {}
	},
	"files": {}
}
```
%%