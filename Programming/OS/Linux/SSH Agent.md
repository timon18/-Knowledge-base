14-10-2021
14:21
***
Tags: #programming #linux 
***
# SSH Agent
`ssh-agent` — это менеджер ключей для SSH.

Он хранит ваши ключи и сертификаты в памяти, незашифрованные и готовые к использованию `ssh`. Это избавляет вас от необходимости вводить пароль каждый раз, когда вы подключаетесь к серверу. Он работает в фоновом режиме в вашей системе, отдельно от `ssh`, и обычно запускается при первом запуске `ssh`.

Пара ключей SSH используется только для аутентификации во время первоначального соединения.

Например, вот как проверяется ключ пользователя во время SSH-соединения, с точки зрения сервера:  
  

-   Клиент предоставляет серверу публичный ключ.
-   Сервер генерирует и отправляет короткое случайное сообщение, прося клиента подписать его с помощью приватного ключа.
-   Клиент просит агента SSH подписать сообщение и пересылает результат обратно на сервер.
-   Сервер проверяет подпись, используя публичный ключ клиента.
-   Теперь у сервера есть доказательство того, что клиент владеет приватным ключом.


Протокол агента настолько прост, что можно было бы написать базовый SSH-agent за день или два. Он имеет только несколько основных операций:  
  

-   Добавить обычную пару ключей (публичный и расшифрованный приватный ключи)
-   Добавить ограниченную пару ключей (публичный и расшифрованный приватный ключи)
-   Добавить ключ (обычный или ограниченный) из смарт-карты (только публичный ключ)
-   Удалить ключ
-   Вывод списка ключей, хранящихся в агенте
-   Подпись сообщения ключом, хранящимся в агенте
-   Блокировка или разблокировка всего агента с помощью пароля

  
Что такое ограниченный ключ? Обычно это ключ, который либо имеет ограниченный срок службы, либо требует явного подтверждения пользователя при его использовании.